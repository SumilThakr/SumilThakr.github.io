<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Air quality impacts of potential US switchgrass production</title>
		<link rel="stylesheet" type="text/css" href="style.css" >
		<style>

.counties {
  fill: silver;
}

.states {
  fill: none;
  stroke: #000;
  stroke-linejoin: round;
}

</style>
	</head>

	<body>
		<script type="text/javascript" src="shapes.js"></script>


		    <svg width="1500" height="1100" fill="none" stroke="#000" stroke-linejoin="round" stroke-linecap="round"></svg>
		    <script src="https://d3js.org/d3.v4.min.js"></script>
				<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
		    <script src="https://d3js.org/topojson.v2.min.js"></script>
		    <script>

		    var svg = d3.select("svg");
				width = +svg.attr("width"),
				height = +svg.attr("height");

				var impacts = d3.map();

		    var path = d3.geoPath();

				var x = d3.scaleLinear()
					.domain([1, 150])
					.rangeRound([300, 800]);

				var color = d3.scaleThreshold()
    			.domain(d3.range(0, 150))
    			.range(d3.quantize(d3.interpolateRgb("white","red"),151))
//					.interpolate(d3.interpolateRgb);
				var yld = 9999
				var nrate = 9999
				var ferttyp = 0
				var pollutant = 0
				var g = svg.append("g")
					.attr("class", "key")
					.attr("transform", "translate(20,30)");

g.selectAll("rect")
  .data(color.range().map(function(d) {
  d = color.invertExtent(d);
  if (d[0] == null) d[0] = x.domain()[0];
  if (d[1] == null) d[1] = x.domain()[1];
  return d;
}))
.enter().append("rect")
	.attr("height", 8)
	.attr("x", function(d) { return x(d[0]); })
	.attr("width", function(d) { return x(d[1]) - x(d[0]); })
	.attr("fill", function(d) { return color(d[0]); });

g.append("text")
  .attr("class", "caption")
  .attr("x", x.range()[0])
  .attr("y", -6)
  .attr("fill", "#000")
  .attr("text-anchor", "start")
  .attr("font-weight", "bold")
  .text("Monetized air quality impacts of switchgrass production");

	g.call(d3.axisBottom(x)
	    .tickSize(13)
	    .tickFormat(function(x, i) { return i ? x : x + " $/Mg"; })
	    .tickValues([10,20,30,40,50,60,70,80,90,100,110,120,130,140,150]))
	  .select(".domain")
	    .remove();

ReDraw(yld, nrate, ferttyp, pollutant)
// This is the function that will be passed through all of the updates.
function ReDraw(yld, nrate, ferttyp, pollutant) {
// Intro
  if (yld == 9999 || nrate == 9999 || pollutant == 9999 || ferttyp == 9999){
        d3.queue()
            .defer(d3.json, "https://d3js.org/us-10m.v1.json")
            .defer(d3.tsv, "intro.tsv", function(d) { impacts.set(d.id, +d.intro); })
            .await(ready);

            function ready(error, us) {
              if (error) throw error;

                svg.append("g")
                    .attr("class", "counties")
                  .selectAll("path")
                  .data(topojson.feature(us, us.objects.counties).features)
                  .enter().append("path")
                    .attr("fill", function(d) { return color(d.intro = impacts.get(d.id)); })
                    .attr("d", path)
                  .append("title")
                    .text(function(d) { return d.intro+ " $/t"; });

                svg.append("path")
                    .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                    .attr("class", "states")
                    .attr("d", path);
              }


          d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
            if (error) throw error;

            svg.append("path")
                .attr("stroke", "#aaa")
                .attr("stroke-width", 0.5)
                .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

            svg.append("path")
                .attr("stroke-width", 0.5)
                .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

            svg.append("path")
                .attr("d", path(topojson.feature(us, us.objects.nation)));
          });
  }
// Yield 9, n rate 50,
  else if (yld == 9 && nrate == 50 && pollutant == 0 && ferttyp == 0){

        d3.queue()
            .defer(d3.json, "https://d3js.org/us-10m.v1.json")
            .defer(d3.tsv, "lylinh3ur.tsv", function(d) { impacts.set(d.id, +d.lylinh3ur); })
            .await(ready);

            function ready(error, us) {
              if (error) throw error;

                svg.append("g")
                    .attr("class", "counties")
                  .selectAll("path")
                  .data(topojson.feature(us, us.objects.counties).features)
                  .enter().append("path")
                    .attr("fill", function(d) { return color(d.lylinh3ur = impacts.get(d.id)); })
                    .attr("d", path)
                  .append("title")
                    .text(function(d) { return d.lylinh3ur + " $/t"; });

                svg.append("path")
                    .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                    .attr("class", "states")
                    .attr("d", path);
              }


          d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
            if (error) throw error;

            svg.append("path")
                .attr("stroke", "#aaa")
                .attr("stroke-width", 0.5)
                .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

            svg.append("path")
                .attr("stroke-width", 0.5)
                .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

            svg.append("path")
                .attr("d", path(topojson.feature(us, us.objects.nation)));
          });
  }
  else if (yld == 9 && nrate == 50 && pollutant == 0 && ferttyp == 1){

        d3.queue()
            .defer(d3.json, "https://d3js.org/us-10m.v1.json")
            .defer(d3.tsv, "lylinh3uan.tsv", function(d) { impacts.set(d.id, +d.lylinh3uan); })
            .await(ready);

            function ready(error, us) {
              if (error) throw error;

                svg.append("g")
                    .attr("class", "counties")
                  .selectAll("path")
                  .data(topojson.feature(us, us.objects.counties).features)
                  .enter().append("path")
                    .attr("fill", function(d) { return color(d.lylinh3uan = impacts.get(d.id)); })
                    .attr("d", path)
                  .append("title")
                    .text(function(d) { return d.lylinh3uan + " $/t"; });

                svg.append("path")
                    .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                    .attr("class", "states")
                    .attr("d", path);
              }


          d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
            if (error) throw error;

            svg.append("path")
                .attr("stroke", "#aaa")
                .attr("stroke-width", 0.5)
                .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

            svg.append("path")
                .attr("stroke-width", 0.5)
                .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

            svg.append("path")
                .attr("d", path(topojson.feature(us, us.objects.nation)));
          });

  }
  else if (yld == 9 && nrate == 50 && pollutant == 1 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lylipm.tsv", function(d) { impacts.set(d.id, +d.lylipm); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lylipm = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lylipm + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 50 && pollutant == 2 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lylivoc.tsv", function(d) { impacts.set(d.id, +d.lylivoc); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lylivoc = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lylivoc + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 50 && pollutant == 3 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lylisox.tsv", function(d) { impacts.set(d.id, +d.lylisox); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lylisox = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lylisox + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 50 && pollutant == 4 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lylinox.tsv", function(d) { impacts.set(d.id, +d.lylinox); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lylinox = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lylinox + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 50 && pollutant == 5 && ferttyp == 0){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lyliurtot.tsv", function(d) { impacts.set(d.id, +d.lyliurtot); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lyliurtot = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lyliurtot + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 50 && pollutant == 5 && ferttyp == 1){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lyliuantot.tsv", function(d) { impacts.set(d.id, +d.lyliuantot); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lyliuantot = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lyliuantot + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
// Yield 9, n rate 100,
  else if (yld == 9 && nrate == 100 && pollutant == 0 && ferttyp == 0){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lyminh3ur.tsv", function(d) { impacts.set(d.id, +d.lyminh3ur); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lyminh3ur = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lyminh3ur + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 100 && pollutant == 0 && ferttyp == 1){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lyminh3uan.tsv", function(d) { impacts.set(d.id, +d.lyminh3uan); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lyminh3uan = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lyminh3uan + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 100 && pollutant == 1 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lymipm.tsv", function(d) { impacts.set(d.id, +d.lymipm); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lymipm = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lymipm + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 100 && pollutant == 2 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lymivoc.tsv", function(d) { impacts.set(d.id, +d.lymivoc); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lymivoc = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lymivoc + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 100 && pollutant == 3 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lymisox.tsv", function(d) { impacts.set(d.id, +d.lymisox); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lymisox = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lymisox + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 100 && pollutant == 4 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lyminox.tsv", function(d) { impacts.set(d.id, +d.lyminox); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lyminox = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lyminox + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 100 && pollutant == 5 && ferttyp == 0){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lymiurtot.tsv", function(d) { impacts.set(d.id, +d.lymiurtot); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lymiurtot = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lymiurtot + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 100 && pollutant == 5 && ferttyp == 1){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lymiuantot.tsv", function(d) { impacts.set(d.id, +d.lymiuantot); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lymiuantot = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lymiuantot + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
// Yield 9, n rate 150,
  else if (yld == 9 && nrate == 150 && pollutant == 0 && ferttyp == 0){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lyhinh3ur.tsv", function(d) { impacts.set(d.id, +d.lyhinh3ur); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lyhinh3ur = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lyhinh3ur + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 150 && pollutant == 0 && ferttyp == 1){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lyhinh3uan.tsv", function(d) { impacts.set(d.id, +d.lyhinh3uan); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lyhinh3uan = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lyhinh3uan + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 150 && pollutant == 1 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lyhipm.tsv", function(d) { impacts.set(d.id, +d.lyhipm); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lyhipm = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lyhipm + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 150 && pollutant == 2 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lyhivoc.tsv", function(d) { impacts.set(d.id, +d.lyhivoc); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lyhivoc = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lyhivoc + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 150 && pollutant == 3 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lyhisox.tsv", function(d) { impacts.set(d.id, +d.lyhisox); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lyhisox = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lyhisox + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 150 && pollutant == 4 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lyhinox.tsv", function(d) { impacts.set(d.id, +d.lyhinox); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lyhinox = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lyhinox + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 150 && pollutant == 5 && ferttyp == 0){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lyhiurtot.tsv", function(d) { impacts.set(d.id, +d.lyhiurtot); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lyhiurtot = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lyhiurtot + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 9 && nrate == 150 && pollutant == 5 && ferttyp == 1){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "lyhiuantot.tsv", function(d) { impacts.set(d.id, +d.lyhiuantot); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.lyhiuantot = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.lyhiuantot + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
// Yield 20, n rate 50,
  else if (yld == 20 && nrate == 50 && pollutant == 0 && ferttyp == 0){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hylinh3ur.tsv", function(d) { impacts.set(d.id, +d.hylinh3ur); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hylinh3ur = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hylinh3ur + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 50 && pollutant == 0 && ferttyp == 1){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hylinh3uan.tsv", function(d) { impacts.set(d.id, +d.hylinh3uan); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hylinh3uan = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hylinh3uan + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 50 && pollutant == 1 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hylipmur.tsv", function(d) { impacts.set(d.id, +d.hylipmur); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hylipmur = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hylipmur + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 50 && pollutant == 2 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hylipmuan.tsv", function(d) { impacts.set(d.id, +d.hylipmuan); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hylipmuan = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hylipmuan + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 50 && pollutant == 3 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hylivoc.tsv", function(d) { impacts.set(d.id, +d.hylivoc); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hylivoc = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hylivoc + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 50 && pollutant == 4 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hylisox.tsv", function(d) { impacts.set(d.id, +d.hylisox); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hylisox = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hylisox + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 50 && pollutant == 5 && ferttyp == 0){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hyliurtot.tsv", function(d) { impacts.set(d.id, +d.hyliurtot); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hyliurtot = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hyliurtot + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 50 && pollutant == 5 && ferttyp == 1){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hyliuantot.tsv", function(d) { impacts.set(d.id, +d.hyliuantot); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hyliuantot = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hyliuantot + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
// Yield 20, n rate 100,
  else if (yld == 20 && nrate == 100 && pollutant == 0 && ferttyp == 0){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hyminh3ur.tsv", function(d) { impacts.set(d.id, +d.hyminh3ur); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hyminh3ur = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hyminh3ur + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 100 && pollutant == 0 && ferttyp == 1){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hyminh3uan.tsv", function(d) { impacts.set(d.id, +d.hyminh3uan); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hyminh3uan = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hyminh3uan + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 100 && pollutant == 1 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hymipm.tsv", function(d) { impacts.set(d.id, +d.hymipm); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hymipm = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hymipm + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 100 && pollutant == 2 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hymivoc.tsv", function(d) { impacts.set(d.id, +d.hymivoc); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hymivoc = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hymivoc + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 100 && pollutant == 3 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hymisox.tsv", function(d) { impacts.set(d.id, +d.hymisox); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hymisox = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hymisox + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 100 && pollutant == 4 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hyminox.tsv", function(d) { impacts.set(d.id, +d.hyminox); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hyminox = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hyminox + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 100 && pollutant == 5 && ferttyp == 0){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hymiurtot.tsv", function(d) { impacts.set(d.id, +d.hymiurtot); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hymiurtot = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hymiurtot + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 100 && pollutant == 5 && ferttyp == 1){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hymiuantot.tsv", function(d) { impacts.set(d.id, +d.hymiuantot); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hymiuantot = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hymiuantot + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
// Yield 20, n rate 150,
  else if (yld == 20 && nrate == 150 && pollutant == 0 && ferttyp == 0){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hyhinh3ur.tsv", function(d) { impacts.set(d.id, +d.hyhinh3ur); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hyhinh3ur = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hyhinh3ur + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 150 && pollutant == 0 && ferttyp == 1){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hyhinh3uan.tsv", function(d) { impacts.set(d.id, +d.hyhinh3uan); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hyhinh3uan = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hyhinh3uan + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 150 && pollutant == 1 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hyhipm.tsv", function(d) { impacts.set(d.id, +d.hyhipm); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hyhipm = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hyhipm + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 150 && pollutant == 2 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hyhivoc.tsv", function(d) { impacts.set(d.id, +d.hyhivoc); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hyhivoc = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hyhivoc + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 150 && pollutant == 3 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hyhisox.tsv", function(d) { impacts.set(d.id, +d.hyhisox); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hyhisox = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hyhisox + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 150 && pollutant == 4 && (ferttyp == 0 || ferttyp == 1)){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hyhinox.tsv", function(d) { impacts.set(d.id, +d.hyhinox); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hyhinox = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hyhinox + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 150 && pollutant == 5 && ferttyp == 0){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hyhiurtot.tsv", function(d) { impacts.set(d.id, +d.hyhiurtot); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hyhiurtot = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hyhiurtot + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
  else if (yld == 20 && nrate == 150 && pollutant == 5 && ferttyp == 1){

          d3.queue()
              .defer(d3.json, "https://d3js.org/us-10m.v1.json")
              .defer(d3.tsv, "hyhiuantot.tsv", function(d) { impacts.set(d.id, +d.hyhiuantot); })
              .await(ready);

              function ready(error, us) {
                if (error) throw error;

                  svg.append("g")
                      .attr("class", "counties")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.counties).features)
                    .enter().append("path")
                      .attr("fill", function(d) { return color(d.hyhiuantot = impacts.get(d.id)); })
                      .attr("d", path)
                    .append("title")
                      .text(function(d) { return d.hyhiuantot + " $/t"; });

                  svg.append("path")
                      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
                      .attr("class", "states")
                      .attr("d", path);
                }


            d3.json("https://d3js.org/us-10m.v1.json", function(error, us) {
              if (error) throw error;

              svg.append("path")
                  .attr("stroke", "#aaa")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

              svg.append("path")
                  .attr("stroke-width", 0.5)
                  .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

              svg.append("path")
                  .attr("d", path(topojson.feature(us, us.objects.nation)));
            });
  }
	else {}
}

// End of the function that will be passed through all of the updates.



// New function for nrate button
				function updatenrate(f,i) {
					if (i ==	0) {
						nrate = 50;
						ReDraw(yld, nrate, ferttyp, pollutant)
					}
				else if (i == 1) {
					nrate = 100
					ReDraw(yld, nrate, ferttyp, pollutant)
				}
				else if (i == 2) {
					nrate = 150
					ReDraw(yld, nrate, ferttyp, pollutant)
				}
				else {
					nrate = 9999
								}
				}

// End new function for nrate scenario buttons




// New function for yld button

function updateyld(f,i) {
	if (i ==	0) {
		yld = 9;
ReDraw(yld, nrate, ferttyp, pollutant)
	}

else if (i == 1) {
	yld = 20;
ReDraw(yld, nrate, ferttyp, pollutant)
}

else {
	yld = 9999;
}

}

// End new function for yield scenario buttons


// New function for pollt button


function updatepollt(f,i) {
	if (i ==	0) {
		pollutant = 0;
		ReDraw(yld, nrate, ferttyp, pollutant)
	}
	else if (i == 1) {
		pollutant = 1;
		ReDraw(yld, nrate, ferttyp, pollutant)
	}
	else if (i == 2) {
		pollutant = 2;
		ReDraw(yld, nrate, ferttyp, pollutant)
	}
	else if (i == 3) {
		pollutant = 3;
		ReDraw(yld, nrate, ferttyp, pollutant)
	}
	else if (i == 4) {
		pollutant = 4;
		ReDraw(yld, nrate, ferttyp, pollutant)
	}
	else if (i == 5) {
		pollutant = 5;
		ReDraw(yld, nrate, ferttyp, pollutant)
	}
	else {
		pollutant = 9999;
	}
}

// End new function for pollt buttons

// New function for ferttyp button


function updatefertype(f,i) {
	if (i ==	0) {
		ferttyp = 0
		ReDraw(yld, nrate, ferttyp, pollutant)
	}
	else if (i == 1) {
	ferttyp = 1
	ReDraw(yld, nrate, ferttyp, pollutant)
	}
	else {
	ferttyp = 9999
	}
}

// End new function for ferttyp buttons

var text= svg.append("text")
								.attr("x",1000)
								.attr("y",150)
								.attr("fill","black")
								.attr("font-size",17)
								.text("The social cost of growing switchgrass in general will")
								var text= svg.append("text")
																.attr("x",1000)
																.attr("y",170)
																.attr("fill","black")
																.attr("font-size",17)
																.text("depend on how and where switchgrass will be grown.")
//								 From the buttons below, choose the scenario for growing switchgrass that you want to \nconsider. The map will then show the monetized \nair quality impacts for growing switchgrass \nin different counties.
var text= svg.append("text")
								.attr("x",1000)
								.attr("y",190)
								.attr("fill","black")
								.attr("font-size",17)
								.text("Choose a growing scenario from the boxes below, and")
								var text= svg.append("text")
																.attr("x",1000)
																.attr("y",210)
																.attr("fill","black")
																.attr("font-size",17)
																.text("the map will show the air quality impacts for growing")
																var text= svg.append("text")
																								.attr("x",1000)
																								.attr("y",230)
																								.attr("fill","black")
																								.attr("font-size",17)
																								.text("1 Mg of switchgrass in each county in the Eastern US.")


																								var text= svg.append("text")
																																.attr("x",1000)
																																.attr("y",520)
																																.attr("fill","black")
																																.attr("font-size",17)
																																.attr("font-style","italic")
																																.text("Source: Thakrar, S.K., Goodkind, A.L., Tessum, C.W., Marshall,")
																								var text= svg.append("text")
																																.attr("x",1000)
																																.attr("y",540)
																																.attr("fill","black")
																																.attr("font-size",17)
																																.attr("font-style","italic")
																																.text("Hill, J.D., Life cycle air quality impacts on human health")
																																var text= svg.append("text")
																																								.attr("x",1000)
																																								.attr("y",560)
																																								.attr("fill","black")
																																								.attr("font-size",17)
																																								.attr("font-style","italic")
																																								.text("from potential switchgrass production in the United States.")
																																								var text= svg.append("text")
																																																.attr("x",1000)
																																																.attr("y",580)
																																																.attr("fill","black")
																																																.attr("font-size",17)
																																																.attr("font-style","italic")
																																																.text("Biomass and Bioenergy, 2017.")


				            var text= svg.append("text")
				                            .attr("x",1000)
				                            .attr("y",270)
				                            .attr("fill","black")
				                            .attr("font-size",17)
				                            .text("Yield scenario (t/ha)")

var text2= svg.append("text")
								.attr("x",1000)
								.attr("y",320)
								.attr("fill","black")
								.attr("font-size",17)
								.text("N application (kg/ha)")

var text2= svg.append("text")
								.attr("x",1000)
								.attr("y",370)
								.attr("fill","black")
								.attr("font-size",17)
								.text("Nitrogen type")

var text2= svg.append("text")
								.attr("x",1000)
								.attr("y",420)
								.attr("fill","black")
								.attr("font-size",17)
								.text("Pollutant")

            //container for yield buttons
            var allButtons= svg.append("g")
                                .attr("id","allButtons")


																            var labels= ["9",'20'];

																            var defaultColor= "#ffeda0"
																            var hoverColor= "#0000ff"
																            var pressedColor= "#000077"

																            //groups for each button (which will hold a rect and text)
																            var buttonGroups= allButtons.selectAll("g.button")
																                                    .data(labels)
																                                    .enter()
																                                    .append("g")
																                                    .attr("class","button")
																                                    .style("cursor","pointer")
																                                    .on("click",function(f,i) {
																                                        updateButtonColors(d3.select(this), d3.select(this.parentNode))
																																				updateyld(f,i)
																                                    })

																                                    .on("mouseover", function() {
																                                        if (d3.select(this).select("rect").attr("fill") != pressedColor) {
																                                            d3.select(this)
																                                                .select("rect")
																                                                .attr("fill",hoverColor);
																                                        }
																                                    })
																                                    .on("mouseout", function() {
																                                        if (d3.select(this).select("rect").attr("fill") != pressedColor) {
																                                            d3.select(this)
																                                                .select("rect")
																                                                .attr("fill",defaultColor);
																                                        }
																                                    })

																            var bWidth= 100; //button width
																            var bHeight= 25; //button height
																            var bSpace= 10; //space between buttons
																            var x0= 1020; //x offset
																            var y0= 280; //y offset

																            //adding a rect to each toggle button group
																            //rx and ry give the rect rounded corner
																            buttonGroups.append("rect")
																                        .attr("class","buttonRect")
																                        .attr("width",bWidth)
																                        .attr("height",bHeight)
																                        .attr("x",function(f,i) {return x0+(bWidth+bSpace)*i;})
																                        .attr("y",y0)
																                        .attr("rx",5) //rx and ry give the buttons rounded corners
																                        .attr("ry",5)
																                        .attr("fill",defaultColor)

																            //adding text to each toggle button group, centered
																            //within the toggle button rect
																            buttonGroups.append("text")
																                        .attr("class","buttonText")
																                        .attr("x",function(f,i) {
																                            return x0 + (bWidth+bSpace)*i + bWidth/2;
																                        })
																                        .attr("y",y0+bHeight/2)
																                        .attr("text-anchor","middle")
																                        .attr("dominant-baseline","central")
																                        .attr("fill","black")
																                        .text(function(f) {return f;})

																            function updateButtonColors(button, parent) {
																                parent.selectAll("rect")
																                        .attr("fill",defaultColor)

																                button.select("rect")
																                        .attr("fill",pressedColor)
																            }


// Nrate buttons


            //container for yield buttons
            var nrateButtons= svg.append("g")
                                .attr("id","nrateButtons")


																            var labels= ['50','100', '150'];


																            var defaultColor= "#ffeda0"
																            var hoverColor= "#feb24c"
																            var pressedColor= "#f03b20"

																            //groups for each button (which will hold a rect and text)
																            var buttonGroups2= nrateButtons.selectAll("g.button")
																                                    .data(labels)
																                                    .enter()
																                                    .append("g")
																                                    .attr("class","button")
																                                    .style("cursor","pointer")
																                                    .on("click",function(f,i) {
																                                        updateButtonColors(d3.select(this), d3.select(this.parentNode))
																																				updatenrate(f,i)
																                                    })

																                                    .on("mouseover", function() {
																                                        if (d3.select(this).select("rect").attr("fill") != pressedColor) {
																                                            d3.select(this)
																                                                .select("rect")
																                                                .attr("fill",hoverColor);
																                                        }
																                                    })
																                                    .on("mouseout", function() {
																                                        if (d3.select(this).select("rect").attr("fill") != pressedColor) {
																                                            d3.select(this)
																                                                .select("rect")
																                                                .attr("fill",defaultColor);
																                                        }
																                                    })

																            var bWidth= 50; //button width
																            var bHeight= 25; //button height
																            var bSpace= 10; //space between buttons
																            var x0= 1020; //x offset
																            var y0= 330; //y offset

																            //adding a rect to each toggle button group
																            //rx and ry give the rect rounded corner
																            buttonGroups2.append("rect")
																                        .attr("class","buttonRect")
																                        .attr("width",bWidth)
																                        .attr("height",bHeight)
																                        .attr("x",function(f,i) {return x0+(bWidth+bSpace)*i;})
																                        .attr("y",y0)
																                        .attr("rx",5) //rx and ry give the buttons rounded corners
																                        .attr("ry",5)
																                        .attr("fill",defaultColor)

																            //adding text to each toggle button group, centered
																            //within the toggle button rect
																            buttonGroups2.append("text")
																                        .attr("class","buttonText")
																                        .attr("x",function(f,i) {
																                            return x0 + (bWidth+bSpace)*i + bWidth/2;
																                        })
																                        .attr("y",y0+bHeight/2)
																                        .attr("text-anchor","middle")
																                        .attr("dominant-baseline","central")
																                        .attr("fill","black")
																                        .text(function(f) {return f;})

																            function updateButtonColors(button, parent) {
																                parent.selectAll("rect")
																                        .attr("fill",defaultColor)

																                button.select("rect")
																                        .attr("fill",pressedColor)
																            }



            //container for ferttyp buttons
            var ferttButtons= svg.append("g")
                                .attr("id","ferttButtons")


																            var labels= ["urea",'UAN'];


																            var defaultColor= "#ffeda0"
																            var hoverColor= "#feb24c"
																            var pressedColor= "#f03b20"

																            //groups for each button (which will hold a rect and text)
																            var buttonGroups3= ferttButtons.selectAll("g.button")
																                                    .data(labels)
																                                    .enter()
																                                    .append("g")
																                                    .attr("class","button")
																                                    .style("cursor","pointer")
																                                    .on("click",function(f,i) {
																                                        updateButtonColors(d3.select(this), d3.select(this.parentNode))
																																				updatefertype(f,i)
																                                    })

																                                    .on("mouseover", function() {
																                                        if (d3.select(this).select("rect").attr("fill") != pressedColor) {
																                                            d3.select(this)
																                                                .select("rect")
																                                                .attr("fill",hoverColor);
																                                        }
																                                    })
																                                    .on("mouseout", function() {
																                                        if (d3.select(this).select("rect").attr("fill") != pressedColor) {
																                                            d3.select(this)
																                                                .select("rect")
																                                                .attr("fill",defaultColor);
																                                        }
																                                    })

																            var bWidth= 50; //button width
																            var bHeight= 25; //button height
																            var bSpace= 10; //space between buttons
																            var x0= 1020; //x offset
																            var y0= 380; //y offset

																            //adding a rect to each toggle button group
																            //rx and ry give the rect rounded corner
																            buttonGroups3.append("rect")
																                        .attr("class","buttonRect")
																                        .attr("width",bWidth)
																                        .attr("height",bHeight)
																                        .attr("x",function(f,i) {return x0+(bWidth+bSpace)*i;})
																                        .attr("y",y0)
																                        .attr("rx",5) //rx and ry give the buttons rounded corners
																                        .attr("ry",5)
																                        .attr("fill",defaultColor)

																            //adding text to each toggle button group, centered
																            //within the toggle button rect
																            buttonGroups3.append("text")
																                        .attr("class","buttonText")
																                        .attr("x",function(f,i) {
																                            return x0 + (bWidth+bSpace)*i + bWidth/2;
																                        })
																                        .attr("y",y0+bHeight/2)
																                        .attr("text-anchor","middle")
																                        .attr("dominant-baseline","central")
																                        .attr("fill","black")
																                        .text(function(f) {return f;})

																            function updateButtonColors(button, parent) {
																                parent.selectAll("rect")
																                        .attr("fill",defaultColor)

																                button.select("rect")
																                        .attr("fill",pressedColor)
																            }




            //container for polltyp buttons
            var polltButtons= svg.append("g")
                                .attr("id","polltButtons")


																            var labels= ['NH3','PM2.5','VOC','SOx','NOx','tot'];


																            var defaultColor= "#ffeda0"
																            var hoverColor= "#feb24c"
																            var pressedColor= "#f03b20"

																            //groups for each button (which will hold a rect and text)
																            var buttonGroups4= polltButtons.selectAll("g.button")
																                                    .data(labels)
																                                    .enter()
																                                    .append("g")
																                                    .attr("class","button")
																                                    .style("cursor","pointer")
																                                    .on("click",function(f,i) {
																                                        updateButtonColors(d3.select(this), d3.select(this.parentNode))
																																				updatepollt(f,i)
																                                    })

																                                    .on("mouseover", function() {
																                                        if (d3.select(this).select("rect").attr("fill") != pressedColor) {
																                                            d3.select(this)
																                                                .select("rect")
																                                                .attr("fill",hoverColor);
																                                        }
																                                    })
																                                    .on("mouseout", function() {
																                                        if (d3.select(this).select("rect").attr("fill") != pressedColor) {
																                                            d3.select(this)
																                                                .select("rect")
																                                                .attr("fill",defaultColor);
																                                        }
																                                    })

																            var bWidth= 50; //button width
																            var bHeight= 25; //button height
																            var bSpace= 10; //space between buttons
																            var x0= 1020; //x offset
																            var y0= 430; //y offset

																            //adding a rect to each toggle button group
																            //rx and ry give the rect rounded corner
																            buttonGroups4.append("rect")
																                        .attr("class","buttonRect")
																                        .attr("width",bWidth)
																                        .attr("height",bHeight)
																                        .attr("x",function(f,i) {return x0+(bWidth+bSpace)*i;})
																                        .attr("y",y0)
																                        .attr("rx",5) //rx and ry give the buttons rounded corners
																                        .attr("ry",5)
																                        .attr("fill",defaultColor)

																            //adding text to each toggle button group, centered
																            //within the toggle button rect
																            buttonGroups4.append("text")
																                        .attr("class","buttonText")
																                        .attr("x",function(f,i) {
																                            return x0 + (bWidth+bSpace)*i + bWidth/2;
																                        })
																                        .attr("y",y0+bHeight/2)
																                        .attr("text-anchor","middle")
																                        .attr("dominant-baseline","central")
																                        .attr("fill","black")
																                        .text(function(f) {return f;})

																            function updateButtonColors(button, parent) {
																                parent.selectAll("rect")
																                        .attr("fill",defaultColor)

																                button.select("rect")
																                        .attr("fill",pressedColor)
																            }


		    </script>



  </body>

</html>
